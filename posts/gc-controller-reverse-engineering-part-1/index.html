<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="GameCube Controller Reverse Engineering (Part 1)" /><meta property="og:locale" content="en" /><meta name="description" content="Motivation" /><meta property="og:description" content="Motivation" /><link rel="canonical" href="https://jefflongo.dev/posts/gc-controller-reverse-engineering-part-1/" /><meta property="og:url" content="https://jefflongo.dev/posts/gc-controller-reverse-engineering-part-1/" /><meta property="og:site_name" content="Jeff Longo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-04T00:10:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="GameCube Controller Reverse Engineering (Part 1)" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-06T08:46:46-07:00","datePublished":"2022-09-04T00:10:00-07:00","description":"Motivation","headline":"GameCube Controller Reverse Engineering (Part 1)","mainEntityOfPage":{"@type":"WebPage","@id":"https://jefflongo.dev/posts/gc-controller-reverse-engineering-part-1/"},"url":"https://jefflongo.dev/posts/gc-controller-reverse-engineering-part-1/"}</script><title>GameCube Controller Reverse Engineering (Part 1) | Jeff Longo</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Jeff Longo"><meta name="application-name" content="Jeff Longo"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Jeff Longo</a></div><div class="site-subtitle font-italic">Embedded engineer and general nerd. Welcome to my blog.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/jefflongo" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jeff.a.longo','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/jeff-longo/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>GameCube Controller Reverse Engineering (Part 1)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="/assets/img/gc_controller_reverse_engineering/gc_controller_reverse_engineering.png" class="preview-img bg" alt="GameCube controller protocol" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>GameCube Controller Reverse Engineering (Part 1)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/jefflongo">Jeff Longo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1662275400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-09-04 </em> </span> <span> Updated <em class="timeago" data-ts="1662479206" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-09-06 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1974 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h2 id="motivation"><span class="mr-2">Motivation</span><a href="#motivation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I’m not the first one to reverse engineer the GameCube controller protocol. However, a lot of the information out there is either incomplete or inacccurate. With the intent to emulate the GameCube controller protocol on a microcontroller, I took a deep dive into understanding the protocol.</p><h2 id="physical-interface"><span class="mr-2">Physical Interface</span><a href="#physical-interface" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The first step in reverse engineering a hardware protocol is to inspect the physical interface. The GameCube controller protocol is actually an extension of the Nintendo 64 controller protocol, which uses single-wire bidirectional communication. The data wire is <em>open drain</em> meaning it is pulled-up via a pull-up resistor (to the 3.3V rail) and when the console or controller wants to talk on the bus, they drive the line low to communicate. This prevents collisions on the bus and is used for other bidirectional single-wire data line protocols such as I2C.</p><p><img data-src="/assets/img/gc_controller_reverse_engineering/pinout.jpg" alt="GameCube controller pinout" data-proofer-ignore> <em>GameCube controller pinout</em></p><p>What makes the GameCube/N64 protocol interesting is the omission of a clock. Most common protocols have a data line and a clock line, where the clock gives a reference for when to read the data line to check if the current bit is a 1 or a 0. Because there is no clock, there must be timing pattern to indicate 1s or 0s.</p><h2 id="capturing-the-protocol"><span class="mr-2">Capturing the Protocol</span><a href="#capturing-the-protocol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The next step after identifying the interface is to capture it in action. One way to do this would be to use an oscilloscope, which creates a graph of voltage versus time. However, because we know that this protocol is a digital protocol (1s and 0s) a logic analyzer is preferable. A logic analyzer performs the same function as an oscilloscope, but only shows 1s and 0s instead of an analog waveform. This means that it’s possible to capture a lot more data in a lot smaller file size, and it’s easier to analyze.</p><p>To take this capture, I opted to use a <a href="https://usd.saleae.com/products/saleae-logic-pro-8">Saleae Logic Pro 8</a>. It is compatible with their <a href="https://www.saleae.com/downloads/">Logic 2</a> software which is an absolutely fantastic piece of software. It is much more intuitive and user-friendly to use than alternatives such as PulseView. The huge advantage to using the Logic software is that it allows you to build a protocol decoder. A protocol decoder can run on a waveform and display it in a user-readable format, instead of inspecting it one bit at a time. The Saleae Logic hardware is no doubt quite expensive. There are, however, cheap knock-offs that also work with the Logic software. They can get the job done, but in my experience only work at pretty slow sample rates, are prone to randomly disconnecting, and do not have the ability to capture analog data as well. The official hardware is well worth the investment.</p><p><img data-src="/assets/img/gc_controller_reverse_engineering/saleae.jpg" alt="Saleae Logic Pro 8 connected to GameCube controller" data-proofer-ignore> <em>Saleae Logic Pro 8 connected to GameCube controller</em></p><p>Equipped with the Saleae Logic, I took some captures of controller’s data line. The protocol is a command/response interface; the console sends a command, and the controller sends a response. Bits are encoded based on the low time of the signal. The console sends bits with a period of 5us, while the controller sends bits with a period of 4us. A 0 is encoded by driving the line low for 75% of the period, and releasing it for the remaining 25%. A 1 is encoded by driving the line low for 25% of the period, and releasing it for the remaining 75%. When the command or response is completed, a 1 bit is sent as a stop bit. The timings are summarized below.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Bit<th style="text-align: center">Low time (us)<th style="text-align: center">High Time (us)<th style="text-align: center">Total Period (us)<tbody><tr><td style="text-align: left">0 (console)<td style="text-align: center">3.75<td style="text-align: center">1.25<td style="text-align: center">5<tr><td style="text-align: left">0 (controller)<td style="text-align: center">3<td style="text-align: center">1<td style="text-align: center">4<tr><td style="text-align: left">1 (console)<td style="text-align: center">1.25<td style="text-align: center">3.75<td style="text-align: center">5<tr><td style="text-align: left">1 (controller)<td style="text-align: center">1<td style="text-align: center">3<td style="text-align: center">4</table></div><p>When there is no controller plugged in, the console polls for controllers by sending the <a href="#id-command-0x00">ID</a> command repeatedly until a controller responds. If a controller fails to respond within ~65us of receiving a command, the console will start sending the ID command again.</p><h2 id="reset-command-0xff"><span class="mr-2">Reset Command (0xFF)</span><a href="#reset-command-0xff" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>A reset command notifies the controller to reset, then responds as if it received an <a href="#id-command-0x00">ID</a> command.</p><h2 id="id-command-0x00"><span class="mr-2">ID Command (0x00)</span><a href="#id-command-0x00" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/gc_controller_reverse_engineering/id.jpg" alt="ID Command" data-proofer-ignore> <em>ID command</em></p><p>In this image, the ID command issued by the console is displayed in red. Note the 8 low bits followed by a high stop bit. The controller responds with a 3 byte bitmap, which tells the console some information about itself, followed by a stop bit. The first 2 bytes describe the type of controller, described in the table below (<a href="http://hitmen.c02.at/files/yagcd/yagcd/chap9.html">source</a>). This table is incomplete. Please reach out if any more accurate information can be provided.</p><h3 id="id-response-bytes-1-and-2"><span class="mr-2">ID Response Bytes 1 and 2</span><a href="#id-response-bytes-1-and-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Bit<th style="text-align: left">Description<tbody><tr><td style="text-align: center">15<td style="text-align: left">Controller is wireless (1 = yes)<tr><td style="text-align: center">14<td style="text-align: left">Controller supports wireless receive? (1 = yes)<tr><td style="text-align: center">13<td style="text-align: left">Controller supports rumble (0 = yes)<tr><td style="text-align: center">12<td style="text-align: left">Controller type (always 0? maybe reserved for future consoles?)<tr><td style="text-align: center">11<td style="text-align: left">Controller type (0 = N64, 1 = GameCube)<tr><td style="text-align: center">10<td style="text-align: left">Wireless type (0 = IF, 1 = RF)<tr><td style="text-align: center">9<td style="text-align: left">Wireless state (0 = variable, 1 = fixed)<tr><td style="text-align: center">8<td style="text-align: left">Non-standard controller (1 = standard GameCube controller)<tr><td style="text-align: center">7<td style="text-align: left">?<tr><td style="text-align: center">6<td style="text-align: left">?<tr><td style="text-align: center">5<td style="text-align: left">Wireless origin (1 = valid)<tr><td style="text-align: center">4<td style="text-align: left">Wireless fix id (1 = fixed)<tr><td style="text-align: center">3<td style="text-align: left">Wireless type (0 = normal, 1 = non-controller?)<tr><td style="text-align: center">2<td style="text-align: left">Wireless type?<tr><td style="text-align: center">1<td style="text-align: left">Wireless type?<tr><td style="text-align: center">0<td style="text-align: left">Wireless type?</table></div><p>The third byte describes the current status of the controller. This byte is context dependent (the content is different for N64 controllers compared to GameCube controllers).</p><h3 id="id-response-byte-3"><span class="mr-2">ID Response Byte 3</span><a href="#id-response-byte-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Bit<th style="text-align: left">Description<tbody><tr><td style="text-align: center">7<td style="text-align: left">Error (1 = error on last transfer)<tr><td style="text-align: center">6<td style="text-align: left">Error (latched)<tr><td style="text-align: center">5<td style="text-align: left">Origin has been sent to console (0 = yes)<tr><td style="text-align: center">[4:3]<td style="text-align: left"><a href="#rumble-mode">Rumble mode</a><tr><td style="text-align: center">[2:0]<td style="text-align: left"><a href="#poll-mode">Poll mode</a></table></div><h2 id="status-command-0x40"><span class="mr-2">Status Command (0x40)</span><a href="#status-command-0x40" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/gc_controller_reverse_engineering/status.jpg" alt="Status command" data-proofer-ignore> <em>Status command</em></p><p>The status command is the most important command. It sends the console the current state of the buttons, joysticks, and shoulders, controls the format they are sent in, and controls rumble. In contrast to the previous commands, the status command has 2 argument bytes that are sent by the console after the command byte. The first argument is the rumble mode and the second argument byte is the poll mode.</p><h3 id="status-command-argument-bytes"><span class="mr-2">Status Command Argument Bytes</span><a href="#status-command-argument-bytes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Byte<th style="text-align: left">Description<tbody><tr><td style="text-align: center">1<td style="text-align: left">Command<tr><td style="text-align: center">2<td style="text-align: left">Rumble mode<tr><td style="text-align: center">3<td style="text-align: left">Poll mode</table></div><h3 id="rumble-mode"><span class="mr-2">Rumble Mode</span><a href="#rumble-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The rumble motor can be in one of three states:</p><ul><li>Off (rumble mode = 0)<li>On (rumble mode = 1)<li>Brake (rumble mode = 2)</ul><p>When the motor is in the <em>on</em> state, 5V is applied to RUMBLE+ and 0V is applied to RUMBLE-. The motor will vibrate. When the motor is in the <em>off</em> state, 5V is applied to RUMBLE+ and RUMBLE- is left open circuit. The motor will stop vibrating. When the motor is in the <em>brake</em> state, 0V is applied to RUMBLE+ and 0V is applied to RUMBLE- (they are shorted). The motor will abruptly stop vibrating.</p><h3 id="poll-mode"><span class="mr-2">Poll Mode</span><a href="#poll-mode" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>There are 5 poll modes that the console can choose from. The poll mode determines the format of the analog values in the status response. Poll mode 3 is by far the most commonly used format. It allows full 8-bit resolution of all the (used) analog inputs. <em>Luigi’s Mansion</em> infamously uses poll mode 0.</p><h5 id="status-response-poll-mode--0"><span class="mr-2">Status Response (poll mode = 0)</span><a href="#status-response-poll-mode--0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Byte<th style="text-align: left">Description<tbody><tr><td style="text-align: center">1 and 2<td style="text-align: left"><a href="#status-response-bytes-1-and-2">See here</a><tr><td style="text-align: center">3<td style="text-align: left">Joystick X<tr><td style="text-align: center">4<td style="text-align: left">Joystick Y<tr><td style="text-align: center">5<td style="text-align: left">C-Stick X<tr><td style="text-align: center">6<td style="text-align: left">C-Stick Y<tr><td style="text-align: center">7<td style="text-align: left">[7:4] L Analog [3:0] R Analog<tr><td style="text-align: center">8<td style="text-align: left">[7:4] A Analog [3:0] B Analog</table></div><h5 id="status-response-poll-mode--1"><span class="mr-2">Status Response (poll mode = 1)</span><a href="#status-response-poll-mode--1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Byte<th style="text-align: left">Description<tbody><tr><td style="text-align: center">1 and 2<td style="text-align: left"><a href="#status-response-bytes-1-and-2">See here</a><tr><td style="text-align: center">3<td style="text-align: left">Joystick X<tr><td style="text-align: center">4<td style="text-align: left">Joystick Y<tr><td style="text-align: center">5<td style="text-align: left">[7:4] C-Stick X [3:0] C-Stick Y<tr><td style="text-align: center">6<td style="text-align: left">L Analog<tr><td style="text-align: center">7<td style="text-align: left">R Analog<tr><td style="text-align: center">8<td style="text-align: left">[7:4] A Analog [3:0] B Analog</table></div><h5 id="status-response-poll-mode--2"><span class="mr-2">Status Response (poll mode = 2)</span><a href="#status-response-poll-mode--2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Byte<th style="text-align: left">Description<tbody><tr><td style="text-align: center">1 and 2<td style="text-align: left"><a href="#status-response-bytes-1-and-2">See here</a><tr><td style="text-align: center">3<td style="text-align: left">Joystick X<tr><td style="text-align: center">4<td style="text-align: left">Joystick Y<tr><td style="text-align: center">5<td style="text-align: left">[7:4] C-Stick X [3:0] C-Stick Y<tr><td style="text-align: center">6<td style="text-align: left">[7:4] L Analog [3:0] R Analog<tr><td style="text-align: center">7<td style="text-align: left">A Analog<tr><td style="text-align: center">8<td style="text-align: left">B Analog</table></div><h5 id="status-response-poll-mode--3"><span class="mr-2">Status Response (poll mode = 3)</span><a href="#status-response-poll-mode--3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Byte<th style="text-align: left">Description<tbody><tr><td style="text-align: center">1 and 2<td style="text-align: left"><a href="#status-response-bytes-1-and-2">See here</a><tr><td style="text-align: center">3<td style="text-align: left">Joystick X<tr><td style="text-align: center">4<td style="text-align: left">Joystick Y<tr><td style="text-align: center">5<td style="text-align: left">C-Stick X<tr><td style="text-align: center">6<td style="text-align: left">C-Stick Y<tr><td style="text-align: center">7<td style="text-align: left">L Analog<tr><td style="text-align: center">8<td style="text-align: left">R Analog</table></div><h5 id="status-response-poll-mode--4"><span class="mr-2">Status Response (poll mode = 4)</span><a href="#status-response-poll-mode--4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5></h5><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Byte<th style="text-align: left">Description<tbody><tr><td style="text-align: center">1 and 2<td style="text-align: left"><a href="#status-response-bytes-1-and-2">See here</a><tr><td style="text-align: center">3<td style="text-align: left">Joystick X<tr><td style="text-align: center">4<td style="text-align: left">Joystick Y<tr><td style="text-align: center">5<td style="text-align: left">C-Stick X<tr><td style="text-align: center">6<td style="text-align: left">C-Stick Y<tr><td style="text-align: center">7<td style="text-align: left">A Analog<tr><td style="text-align: center">8<td style="text-align: left">B Analog</table></div><p>The astute reader will notice mention of an A and B analog. This was likely a feature that was dropped for production. In fact, I’m pretty confident that there are A and B analog pins on the controller ASIC that probably work and are left unconnected. It would be interesting to see if someone were to find them and apply voltage to them if they would respond accordingly in the response.</p><h3 id="status-response-bytes-1-and-2"><span class="mr-2">Status Response Bytes 1 and 2</span><a href="#status-response-bytes-1-and-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>The first 2 bytes in the response of a status command describe the state of the controller’s buttons and status, shown in the table below.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Bit<th style="text-align: left">Description<tbody><tr><td style="text-align: center">15<td style="text-align: left">Use the controller origin (1 = yes, not confirmed)<tr><td style="text-align: center">14<td style="text-align: left">L (1 = pressed)<tr><td style="text-align: center">13<td style="text-align: left">R (1 = pressed)<tr><td style="text-align: center">12<td style="text-align: left">Z (1 = pressed)<tr><td style="text-align: center">11<td style="text-align: left">D-Pad Up (1 = pressed)<tr><td style="text-align: center">10<td style="text-align: left">D-Pad Down (1 = pressed)<tr><td style="text-align: center">9<td style="text-align: left">D-Pad Right (1 = pressed)<tr><td style="text-align: center">8<td style="text-align: left">D-Pad Left (1 = pressed)<tr><td style="text-align: center">7<td style="text-align: left">Error (1 = error on last transfer)<tr><td style="text-align: center">6<td style="text-align: left">Error (latched)<tr><td style="text-align: center">5<td style="text-align: left">Origin has been sent to console (0 = yes)<tr><td style="text-align: center">4<td style="text-align: left">Start (1 = pressed)<tr><td style="text-align: center">3<td style="text-align: left">Y (1 = pressed)<tr><td style="text-align: center">2<td style="text-align: left">X (1 = pressed)<tr><td style="text-align: center">1<td style="text-align: left">B (1 = pressed)<tr><td style="text-align: center">0<td style="text-align: left">A (1 = pressed)</table></div><h3 id="poll-rate"><span class="mr-2">Poll Rate</span><a href="#poll-rate" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Because the GameCube had no kernel, controller polling is done completely in hardware. The console configures the poll rate by configuring the number of horizontal lines that are rendered between successive polls (<a href="https://www.gc-forever.com/yagcd/chap5.html#sec5.8">source</a>). Many games poll at 60Hz, but some games, such as <em>Super Smash Bros. Melee</em>, poll at 120Hz. The console is capable of polling at speeds as high as 2KHz.</p><h2 id="origin-command-0x41"><span class="mr-2">Origin Command (0x41)</span><a href="#origin-command-0x41" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/gc_controller_reverse_engineering/origin.jpg" alt="Origin command" data-proofer-ignore> <em>Origin command</em></p><p>The origin command tells the console what the state of the controller was when it came out of reset. It is used to calibrate the analog controls if they are naturally uncentered. The origin value gets subtracted off of any given analog input before a game processes it. For example, if the joystick x-axis origin was at x = 5 (assume center is 0), and the current value is 5, the value a game would use would be the current value minus the origin value, resulting in a value of 0. In other words, it “shifts” the joystick’s center to the origin value. This command (or a <a href="#recalibrate-command-0x42">recalibrate</a> command) immediately follows the response of an ID command. The controller responds with 10 bytes. The first 2 bytes are the same as the <a href="#status-response-bytes-1-and-2">first 2 bytes</a> in the response to a status command. When the console requests a controller’s origin, the <em>Origin has been sent to console</em> bit in the ID, origin, and status commands are cleared.</p><p>The remaining 8 bytes describe the analog inputs. These bytes are described in the table below.</p><h3 id="origin-response-bytes-3-to-10"><span class="mr-2">Origin Response Bytes 3 to 10</span><a href="#origin-response-bytes-3-to-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Byte<th style="text-align: left">Description<tbody><tr><td style="text-align: center">3<td style="text-align: left">Joystick X<tr><td style="text-align: center">4<td style="text-align: left">Joystick Y<tr><td style="text-align: center">5<td style="text-align: left">C-Stick X<tr><td style="text-align: center">6<td style="text-align: left">C-Stick Y<tr><td style="text-align: center">7<td style="text-align: left">L Analog<tr><td style="text-align: center">8<td style="text-align: left">R Analog<tr><td style="text-align: center">9<td style="text-align: left">A Analog<tr><td style="text-align: center">10<td style="text-align: left">B Analog</table></div><h2 id="recalibrate-command-0x42"><span class="mr-2">Recalibrate Command (0x42)</span><a href="#recalibrate-command-0x42" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/gc_controller_reverse_engineering/recalibrate.jpg" alt="Recalibrate command" data-proofer-ignore> <em>Recalibrate command</em></p><p>This command is functionally very similar to the <a href="#origin-command-0x41">origin</a> command. It tells the controller to capture new origin values and report them to the console. The response format is the same as an origin command. However, it does have 2 command arguments like the status command. It’s unclear whether these arguments are used. They are both always 0x00. This command is sometimes used instead of the origin command. For example, when booting up the GameCube or Wii system menu.</p><h2 id="long-status-command-0x43"><span class="mr-2">“Long” Status Command (0x43)</span><a href="#long-status-command-0x43" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This command was found by <a href="https://en.wikipedia.org/wiki/Fuzzing">fuzzing</a> the controller and is apparently only used by the GameCube Service Disc (source: <a href="https://github.com/extremscorner">Extrem</a>). It has 2 command arguments, like the <a href="#recalibrate-command-0x42">recalibrate</a> command, that are possibly unused. It returns the controller status in the 10 byte format of an <a href="#origin-command-0x41">origin</a>.</p><h2 id="to-be-continued"><span class="mr-2">To Be Continued..</span><a href="#to-be-continued" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Check out part 2 <a href="/posts/gc-controller-reverse-engineering-part-2/">here</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/projects/'>Projects</a>, <a href='/categories/gamecube-controller/'>GameCube Controller</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/wii/" class="post-tag no-text-decoration" >wii</a> <a href="/tags/gamecube/" class="post-tag no-text-decoration" >gamecube</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=GameCube Controller Reverse Engineering (Part 1) - Jeff Longo&amp;url=https://jefflongo.dev/posts/gc-controller-reverse-engineering-part-1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=GameCube Controller Reverse Engineering (Part 1) - Jeff Longo&amp;u=https://jefflongo.dev/posts/gc-controller-reverse-engineering-part-1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://jefflongo.dev/posts/gc-controller-reverse-engineering-part-1/&amp;text=GameCube Controller Reverse Engineering (Part 1) - Jeff Longo" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/gc-controller-reverse-engineering-part-1/">GameCube Controller Reverse Engineering (Part 1)</a><li><a href="/posts/gc-adapter-reverse-engineering/">GameCube Adapter Reverse Engineering</a><li><a href="/posts/2018-portable-wii/">From Knowing Nothing to Building a Portable Wii</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/gamecube/">gamecube</a> <a class="post-tag" href="/tags/wii/">wii</a> <a class="post-tag" href="/tags/3d-printing/">3d-printing</a> <a class="post-tag" href="/tags/guitar/">guitar</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/keyboards/">keyboards</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/web-scraping/">web-scraping</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/gc-controller-reverse-engineering-part-2/"><div class="card-body"> <em class="timeago small" data-ts="1662275460" > 2022-09-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GameCube Controller Reverse Engineering (Part 2)</h3><div class="text-muted small"><p> This is a continuation to GameCube Controller Reverse Engineering (Part 1). Be sure to check that out if you haven’t already. Decoding the Commands To validate all of the previous protocol resear...</p></div></div></a></div><div class="card"> <a href="/posts/gc-adapter-reverse-engineering/"><div class="card-body"> <em class="timeago small" data-ts="1662413100" > 2022-09-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GameCube Adapter Reverse Engineering</h3><div class="text-muted small"><p> Discrepancies with Emulators Dolphin Emulator, a Wii/GameCube console emulator, added native support for the official Nintendo GameCube controller adapter back in 2014. This was a huge step forwar...</p></div></div></a></div><div class="card"> <a href="/posts/2018-portable-wii/"><div class="card-body"> <em class="timeago small" data-ts="1647794940" > 2022-03-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>From Knowing Nothing to Building a Portable Wii</h3><div class="text-muted small"><p> The Beginning I somehow stumbled across this video of a portable GameCube. I was instantly obsessed and knew I had to make one too. At this point in time, I had recently graduated high school, and...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/2021-wii-portable/" class="btn btn-outline-primary" prompt="Older"><p>Portable Wii Endgame</p></a> <a href="/posts/gc-controller-reverse-engineering-part-2/" class="btn btn-outline-primary" prompt="Newer"><p>GameCube Controller Reverse Engineering (Part 2)</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "jefflongo/blog-comments", "data-repo-id": "R_kgDOHCLY9g", "data-category": "Announcements", "data-category-id": "DIC_kwDOHCLY9s4COMIn", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/jefflongo">Jeff Longo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/gamecube/">gamecube</a> <a class="post-tag" href="/tags/wii/">wii</a> <a class="post-tag" href="/tags/3d-printing/">3d-printing</a> <a class="post-tag" href="/tags/guitar/">guitar</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/keyboards/">keyboards</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/web-scraping/">web-scraping</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-8D5SLD81DC"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-8D5SLD81DC'); }); </script>
